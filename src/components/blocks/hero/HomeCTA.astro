---
import Section from '../../ui/Section.astro'
import Row from '../../ui/Row.astro'
import Col from '../../ui/Col.astro'
// - UI
import Button from '../../ui/Button.astro'
import { Image } from 'astro:assets'

// Content
import heroImage from '../../../assets/hero-01.png'
---
<Section id="intro" padding="none" classes="bg-neutral-50 dark:bg-neutral-900">
    <Row>
        <Col span="2" />
        <Col span="8" align="center">
            <br><br><h1>Exploring <strong>dream meanings</strong> and enhancing self-understanding.</h1>
            
            <p class="pb-0 text-lg"> Decode the hidden messages of your dreams and awaken your inner wisdom.</p><br><br>
        </Col>
        <Col span="2" />
    </Row>
</Section>

<Section id="hero-image" padding="none" classes="bg-neutral-50 dark:bg-neutral-900">
    <Row>
        <Col span="2" />
        <Col span="8" align="center">
            <Image
                src={heroImage}
                alt="AI-powered dream analyzer tool"
                class="max-w-full h-auto"
                format="webp"
            />
        </Col>
        <Col span="2" />
    </Row>
</Section>

<Section id="dream-form" padding="none" classes="bg-neutral-50 dark:bg-neutral-900">
    <Row>
        <Col span="2" />
        <Col span="8" align="center">
            <h2 class="text-3xl font-semibold mb-4">Gain access to deep dream analysis through our <strong>AI-Powered Analyzer</strong> tool. </h2>
			<label for="dreamDescription" class="block text-lg font-medium mb-2">Designed to reveal the significant messages and insights within your dreams.</label>
			<p class="text-sm text-gray-500 dark:text-gray-300 mb-4">
				Note: Insights are generated by the Gemini-1.5-Flash model. Please use this tool responsibly; the results are intended for general guidance only.
			</p>			
            <form id="dreamForm" class="space-y-4">
                
                <textarea id="dreamDescription" name="dreamDescription" rows="4" cols="50" minlength="30" required class="w-full p-2 border border-gray-300 rounded" placeholder="Enter a detailed description of your dream..."></textarea>
                <p id="analysisResult" class="mt-4"></p> <!-- Moved up here -->
                <div class="flex justify-center space-x-4 mt-4">
                    <Button size="lg" type="submit">Analyze Your Dream</Button>
                    <Button size="lg" link="/blog">Explore Related Dreams</Button>
                </div>
				<br><br>
            </form>
        </Col>
        <Col span="2" />
    </Row>
</Section>

<script type="module">
    document.getElementById('dreamForm').addEventListener('submit', async (event) => {
        event.preventDefault();
        const dreamDescription = document.getElementById('dreamDescription').value;

        const response = await fetch('https://analyzemydream-gemini.vercel.app/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ dream_description: dreamDescription }),
        });

        const result = await response.json();
        if (response.ok) {
            document.getElementById('analysisResult').textContent = result.analysis;
        } else {
            document.getElementById('analysisResult').textContent = result.error;
        }
    });
</script>
